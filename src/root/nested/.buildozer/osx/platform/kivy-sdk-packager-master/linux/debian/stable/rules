#!/usr/bin/make -f
# -*- makefile -*-
# Sample debian/rules that uses debhelper.
# This file was originally written by Joey Hess and Craig Small.
# As a special exception, when this file is copied by dh-make into a
# dh-make output file, you may use that output file without restriction.
# This special exception was added by Craig Small in version 0.37 of dh-make.

# Uncomment this to turn on verbose mode.
export DH_VERBOSE=1

%:
	dh $@ --with python2,python3

override_dh_auto_build:
	echo "Skipping any builds - doing them on install..."

override_dh_installdocs:
	$(MAKE) build
	cd doc && PYTHONPATH=.. make html
	dh_installdocs
	$(MAKE) distclean

override_dh_auto_install:
	for PYX in $(shell pyversions -r) $(shell py3versions -r) ; do \
	    $(MAKE) install PYTHON=$$PYX INSTALL_ROOT=$(CURDIR)/debian/tmp INSTALL_PREFIX=/usr INSTALL_LAYOUT=deb; \
	    $(MAKE) distclean; \
	done

override_dh_auto_test:
	#xvfb-run -s "+extension GLX" dh_auto_test
	echo "! TESTS ARE TEMPORARY DISABLED !"

override_dh_install:
	dh_install --fail-missing -X shapecollisions.py --sourcedir debian/tmp
